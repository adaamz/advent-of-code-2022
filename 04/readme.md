After lot of time it returned some code that is able to pass example data, but for final input it was wrong result.
